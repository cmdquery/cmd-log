import{r as b,c as s,o as a,a as e,F as h,h as p,g as d,t as o,l as V,n as T,m as z,j as E,b as H,v as W,y as q,x as v,z as G}from"./index-BNxQXDrL.js";import{_ as I}from"./StatusToggle-DHu0Stod.js";const K={class:"backtrace"},Q={key:0,class:"empty-state"},X={key:1},Y=["onClick"],Z={class:"backtrace__frame-number"},ee={key:0,class:"backtrace__frame-file"},te={key:0,class:"backtrace__frame-line"},se={key:1,class:"text-muted"},ae={class:"code"},oe={key:0,class:"backtrace__code"},le={class:"backtrace__line-number"},ne={class:"backtrace__line-content"},ce={key:1},re={class:"backtrace__line-number"},ie={class:"backtrace__line-content"},B={__name:"BacktraceViewer",props:{backtrace:{type:Array,default:()=>[]}},setup(m){const y=b(new Set([0])),g=l=>{y.value.has(l)?y.value.delete(l):y.value.add(l)};return(l,c)=>(a(),s("div",K,[!m.backtrace||m.backtrace.length===0?(a(),s("div",Q,[...c[0]||(c[0]=[e("div",{class:"empty-state__icon"},"ðŸ“­",-1),e("div",{class:"empty-state__text"},"No backtrace available",-1)])])):(a(),s("div",X,[(a(!0),s(h,null,p(m.backtrace,(r,_)=>(a(),s("div",{key:_,class:"backtrace__frame"},[e("div",{class:"backtrace__frame-header",onClick:k=>g(_)},[e("span",Z,o(_+1),1),r.file?(a(),s("span",ee,[V(o(r.file),1),r.line?(a(),s("span",te,":"+o(r.line),1)):d("",!0)])):d("",!0),r.function?(a(),s("span",se,[c[1]||(c[1]=V(" in ",-1)),e("span",ae,o(r.function),1)])):d("",!0)],8,Y),y.value.has(_)?(a(),s("div",oe,[r.code?(a(),s("div",{key:0,class:T(["backtrace__code-line",{"is-highlighted":!0}])},[e("span",le,o(r.line),1),e("span",ne,o(r.code),1)])):d("",!0),r.context?(a(),s("div",ce,[(a(!0),s(h,null,p(r.context,(k,u)=>(a(),s("div",{key:u,class:"backtrace__code-line"},[e("span",re,o(u+1),1),e("span",ie,o(k),1)]))),128))])):d("",!0)])):d("",!0)]))),128))]))]))}},de={class:"breadcrumb-viewer"},ue={key:0,class:"empty-state p-6"},_e={key:1},ve={class:"breadcrumb-viewer__time"},be={class:"breadcrumb-viewer__message"},me={key:0,class:"breadcrumb-viewer__data"},ye={__name:"BreadcrumbViewer",props:{breadcrumbs:{type:Array,default:()=>[]}},setup(m){const y=l=>l?new Date(l).toLocaleTimeString():"",g=l=>({http:"text-blue",navigation:"text-green",click:"text-purple",console:"text-orange",error:"text-red"})[l==null?void 0:l.toLowerCase()]||"";return(l,c)=>(a(),s("div",de,[c[1]||(c[1]=e("div",{class:"breadcrumb-viewer__header"},[e("span",{class:"breadcrumb-viewer__title"},"Breadcrumbs")],-1)),!m.breadcrumbs||m.breadcrumbs.length===0?(a(),s("div",ue,[...c[0]||(c[0]=[e("div",{class:"empty-state__icon"},"ðŸž",-1),e("div",{class:"empty-state__text"},"No breadcrumbs available",-1)])])):(a(),s("div",_e,[(a(!0),s(h,null,p(m.breadcrumbs,(r,_)=>(a(),s("div",{key:_,class:"breadcrumb-viewer__item"},[e("span",ve,o(y(r.time)),1),e("span",{class:T(["breadcrumb-viewer__category",g(r.category)])},o(r.category),3),e("span",be,o(r.message),1),r.metadata&&Object.keys(r.metadata).length>0?(a(),s("div",me,o(JSON.stringify(r.metadata,null,2)),1)):d("",!0)]))),128))]))]))}},ke={key:0,class:"error-detail-page"},he={class:"detail-header"},pe={class:"detail-title"},ge={class:"detail-subtitle"},fe={class:"text-muted"},xe={class:"detail-actions"},$e={class:"flex gap-6"},we={class:"flex-1"},Ce={class:"tabs"},Ne=["onClick"],Ee={class:"tab-content"},Te={key:0,class:"tab-panel"},Se={class:"flex flex-col gap-6"},Ae={class:"detail-item"},Oe={class:"flex items-center gap-3"},Fe={class:"text-body-sm"},Ve={class:"card"},Be={class:"code-block"},Le={class:"code-block__content"},De={key:0,class:"card"},Re={class:"card"},je={class:"badge-group"},Je={key:1,class:"tab-panel"},Pe={class:"card mb-6"},Ue={class:"form-group"},Me={class:"flex flex-col gap-4"},ze={class:"flex justify-between mb-2"},He={class:"text-body-sm font-medium"},We={class:"text-caption"},qe={class:"text-body-sm"},Ge={key:0,class:"card card--empty"},Ie={key:2,class:"tab-panel"},Ke={key:3,class:"tab-panel"},Qe={class:"card"},Xe={key:0,class:"code-block"},Ye={class:"code-block__content"},Ze={key:1,class:"card__body text-muted"},et={key:4,class:"tab-panel"},tt={key:5,class:"tab-panel"},st={class:"card"},at={key:0,class:"code-block"},ot={class:"code-block__content"},lt={key:1,class:"card__body text-muted"},nt={key:6,class:"tab-panel"},ct={class:"card"},rt={class:"flex flex-col"},it={class:"flex items-center gap-3"},dt={class:"badge badge--xs"},ut={key:0,class:"text-body-sm"},_t={class:"text-caption"},vt={key:0,class:"py-6 text-center text-muted"},bt={class:"w-80 flex-shrink-0"},mt={class:"flex flex-col gap-4"},yt={class:"card"},kt={class:"metric-card__value"},ht={class:"card"},pt={class:"text-body"},gt={class:"card"},ft={class:"text-body"},xt={key:1,class:"loading-spinner"},Ct={__name:"ErrorDetail",setup(m){const y=q(),g=G(),l=b(null),c=b(null),r=b([]),_=b([]),k=b(null),u=b("summary"),f=b(""),L=b(!1),D=[{key:"summary",label:"Summary"},{key:"comments",label:"Comments"},{key:"backtrace",label:"Backtrace"},{key:"context",label:"Context"},{key:"breadcrumbs",label:"Breadcrumbs"},{key:"environment",label:"Environment"},{key:"history",label:"History"}],$=async()=>{try{const i=y.params.id;l.value=await v(`/api/v1/faults/${i}`);const t=await v(`/api/v1/faults/${i}/notices?limit=1`);t.notices&&t.notices.length>0&&(c.value=t.notices[0]),k.value=await v(`/api/v1/faults/${i}/stats`);const C=await v(`/api/v1/faults/${i}/comments`);r.value=C.comments||[];const N=await v(`/api/v1/faults/${i}/history`);_.value=N.history||[]}catch(i){console.error("Error loading fault:",i)}},R=async i=>{try{const t=i?"resolve":"unresolve";await v(`/api/v1/faults/${l.value.id}/${t}`,{method:"POST"}),await $()}catch(t){console.error("Error updating resolved status:",t)}},j=async()=>{if(f.value.trim())try{await v(`/api/v1/faults/${l.value.id}/comments`,{method:"POST",body:JSON.stringify({comment:f.value,user_id:1})}),f.value="",await $()}catch(i){console.error("Error adding comment:",i)}},J=async()=>{console.log("Assign fault")},P=async()=>{try{await v(`/api/v1/faults/${l.value.id}/ignore`,{method:"POST"}),await $()}catch(i){console.error("Error ignoring fault:",i)}},U=()=>{console.log("Export fault")},M=async()=>{if(confirm("Are you sure you want to delete this error?"))try{await v(`/api/v1/faults/${l.value.id}`,{method:"DELETE"}),g.push("/errors")}catch(i){console.error("Error deleting fault:",i)}},w=i=>{console.log("Navigate",i)},x=i=>i?new Date(i).toLocaleString():"";return z(()=>{$()}),(i,t)=>{var C,N,A,O,F;return l.value?(a(),s("div",ke,[e("div",he,[e("div",null,[e("h1",pe,o(l.value.error_class),1),e("div",ge,[e("span",fe,"Last seen "+o(x(l.value.last_seen_at)),1),t[7]||(t[7]=e("span",{class:"mx-2 text-muted"},"â€¢",-1)),e("span",{class:T(["env-badge",`env-${l.value.environment}`])},o(l.value.environment),3)])]),e("div",xe,[e("button",{class:"btn btn--ghost btn--sm",onClick:t[0]||(t[0]=n=>w("first"))},"First"),e("button",{class:"btn btn--ghost btn--sm",onClick:t[1]||(t[1]=n=>w("prev"))},"â† Prev"),e("button",{class:"btn btn--ghost btn--sm",onClick:t[2]||(t[2]=n=>w("next"))},"Next â†’"),e("button",{class:"btn btn--ghost btn--sm",onClick:t[3]||(t[3]=n=>w("last"))},"Last")])]),e("div",$e,[e("div",we,[e("div",Ce,[(a(),s(h,null,p(D,n=>e("button",{key:n.key,class:T(["tab",{"is-active":u.value===n.key}]),onClick:S=>u.value=n.key},o(n.label),11,Ne)),64))]),e("div",Ee,[u.value==="summary"?(a(),s("div",Te,[e("div",Se,[e("div",Ae,[t[8]||(t[8]=e("div",{class:"detail-label"},"Status",-1)),e("div",Oe,[E(I,{modelValue:l.value.resolved,"onUpdate:modelValue":[t[4]||(t[4]=n=>l.value.resolved=n),R]},null,8,["modelValue"]),e("span",Fe,o(l.value.resolved?"Resolved":"Unresolved"),1)])]),e("div",Ve,[t[9]||(t[9]=e("div",{class:"card__header"},[e("h3",{class:"h5"},"Message")],-1)),e("div",Be,[e("div",Le,[e("pre",null,o(l.value.message),1)])])]),c.value&&c.value.backtrace?(a(),s("div",De,[t[10]||(t[10]=e("div",{class:"card__header"},[e("h3",{class:"h5"},"Backtrace")],-1)),E(B,{backtrace:c.value.backtrace},null,8,["backtrace"])])):d("",!0),e("div",Re,[t[11]||(t[11]=e("div",{class:"card__header"},[e("h3",{class:"h5"},"Tags")],-1)),e("div",je,[(a(!0),s(h,null,p(l.value.tags,n=>(a(),s("span",{key:n,class:"badge"},o(n),1))),128)),e("button",{class:"btn btn--ghost btn--sm",onClick:t[5]||(t[5]=n=>L.value=!0)}," + Add Tag ")])])])])):d("",!0),u.value==="comments"?(a(),s("div",Je,[e("div",Pe,[e("div",Ue,[H(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=n=>f.value=n),placeholder:"Add a comment...",class:"form-textarea",rows:"3"},null,512),[[W,f.value]])]),e("button",{onClick:j,class:"btn btn--brand"},"Add Comment")]),e("div",Me,[(a(!0),s(h,null,p(r.value,n=>{var S;return a(),s("div",{key:n.id,class:"card"},[e("div",ze,[e("span",He,o(((S=n.user)==null?void 0:S.name)||"Unknown"),1),e("span",We,o(x(n.created_at)),1)]),e("p",qe,o(n.comment),1)])}),128)),r.value.length===0?(a(),s("div",Ge,[...t[12]||(t[12]=[e("div",{class:"card__text"},"No comments yet",-1)])])):d("",!0)])])):d("",!0),u.value==="backtrace"?(a(),s("div",Ie,[E(B,{backtrace:((C=c.value)==null?void 0:C.backtrace)||[]},null,8,["backtrace"])])):d("",!0),u.value==="context"?(a(),s("div",Ke,[e("div",Qe,[t[13]||(t[13]=e("div",{class:"card__header"},[e("h3",{class:"h5"},"Custom Context")],-1)),c.value&&c.value.context?(a(),s("div",Xe,[e("div",Ye,[e("pre",null,o(JSON.stringify(c.value.context,null,2)),1)])])):(a(),s("div",Ze,"No context data available"))])])):d("",!0),u.value==="breadcrumbs"?(a(),s("div",et,[E(ye,{breadcrumbs:((N=c.value)==null?void 0:N.breadcrumbs)||[]},null,8,["breadcrumbs"])])):d("",!0),u.value==="environment"?(a(),s("div",tt,[e("div",st,[t[14]||(t[14]=e("div",{class:"card__header"},[e("h3",{class:"h5"},"Application Environment")],-1)),c.value&&c.value.environment?(a(),s("div",at,[e("div",ot,[e("pre",null,o(JSON.stringify(c.value.environment,null,2)),1)])])):(a(),s("div",lt,"No environment data available"))])])):d("",!0),u.value==="history"?(a(),s("div",nt,[e("div",ct,[e("div",rt,[(a(!0),s(h,null,p(_.value,n=>(a(),s("div",{key:n.id,class:"flex items-center justify-between py-3 border-b border-primary",style:{"border-color":"var(--border-primary)"}},[e("div",it,[e("span",dt,o(n.action),1),n.user?(a(),s("span",ut,o(n.user.name||n.user.email),1)):d("",!0)]),e("span",_t,o(x(n.created_at)),1)]))),128)),_.value.length===0?(a(),s("div",vt," No history available ")):d("",!0)])])])):d("",!0)])]),e("div",bt,[e("div",mt,[e("div",yt,[t[15]||(t[15]=e("div",{class:"detail-label mb-2"},"Total Occurrences",-1)),e("div",kt,o(((A=k.value)==null?void 0:A.total_occurrences)||0),1)]),e("div",ht,[t[16]||(t[16]=e("div",{class:"detail-label mb-2"},"Last Occurred",-1)),e("div",pt,o(x((O=k.value)==null?void 0:O.last_occurred)||"â€”"),1)]),e("div",gt,[t[17]||(t[17]=e("div",{class:"detail-label mb-2"},"First Occurred",-1)),e("div",ft,o(x((F=k.value)==null?void 0:F.first_occurred)||"â€”"),1)]),e("div",{class:"card"},[t[18]||(t[18]=e("div",{class:"detail-label mb-3"},"Actions",-1)),e("div",{class:"flex flex-col gap-2"},[e("button",{class:"btn btn--secondary btn--sm w-full",onClick:J}," Assign "),e("button",{class:"btn btn--secondary btn--sm w-full",onClick:P}," Ignore "),e("button",{class:"btn btn--secondary btn--sm w-full",onClick:U}," Export "),e("button",{class:"btn btn--danger btn--sm w-full",onClick:M}," Delete ")])])])])])])):(a(),s("div",xt,[...t[19]||(t[19]=[e("div",{class:"spinner"},null,-1)])]))}}};export{Ct as default};
