import{_ as T,c as s,o as a,F as b,h,b as e,g as i,t as n,l as j,r as m,m as z,j as E,n as B,a as H,v as W,y as q,x as u,z as G}from"./index-BVQZcSNY.js";import{S as K}from"./StatusToggle-BJbrDQNb.js";const Q={class:"backtrace-viewer"},X={key:0,class:"empty"},Y={key:1,class:"backtrace-list"},Z={class:"frame-header"},ee={class:"frame-number"},te={key:0,class:"frame-file"},se={key:0},ae={key:1,class:"frame-function"},oe={key:0,class:"frame-code"},ne={key:1,class:"frame-context"},le={__name:"BacktraceViewer",props:{backtrace:{type:Array,default:()=>[]}},setup(v){return(p,_)=>(a(),s("div",Q,[!v.backtrace||v.backtrace.length===0?(a(),s("div",X," No backtrace available ")):(a(),s("div",Y,[(a(!0),s(b,null,h(v.backtrace,(l,r)=>(a(),s("div",{key:r,class:"backtrace-frame"},[e("div",Z,[e("span",ee,n(r+1),1),l.file?(a(),s("span",te,[j(n(l.file),1),l.line?(a(),s("span",se,":"+n(l.line),1)):i("",!0)])):i("",!0),l.function?(a(),s("span",ae," in "+n(l.function),1)):i("",!0)]),l.code?(a(),s("div",oe,[e("pre",null,[e("code",null,n(l.code),1)])])):i("",!0),l.context?(a(),s("div",ne,[e("pre",null,[e("code",null,n(l.context),1)])])):i("",!0)]))),128))]))]))}},F=T(le,[["__scopeId","data-v-f2bbf952"]]),re={class:"breadcrumb-viewer"},ce={key:0,class:"empty"},ie={key:1,class:"breadcrumb-list"},de={class:"breadcrumb-header"},ue={class:"breadcrumb-category"},ve={class:"breadcrumb-time"},me={class:"breadcrumb-message"},_e={key:0,class:"breadcrumb-metadata"},be={__name:"BreadcrumbViewer",props:{breadcrumbs:{type:Array,default:()=>[]}},setup(v){const p=_=>_?new Date(_).toLocaleString():"";return(_,l)=>(a(),s("div",re,[!v.breadcrumbs||v.breadcrumbs.length===0?(a(),s("div",ce," No breadcrumbs available ")):(a(),s("div",ie,[(a(!0),s(b,null,h(v.breadcrumbs,(r,g)=>(a(),s("div",{key:g,class:"breadcrumb-item"},[e("div",de,[e("span",ue,n(r.category),1),e("span",ve,n(p(r.time)),1)]),e("div",me,n(r.message),1),r.metadata&&Object.keys(r.metadata).length>0?(a(),s("div",_e,[e("pre",null,n(JSON.stringify(r.metadata,null,2)),1)])):i("",!0)]))),128))]))]))}},he=T(be,[["__scopeId","data-v-1a6a1922"]]),ye={key:0,class:"error-detail-page"},ke={class:"error-header"},pe={class:"header-main"},ge={class:"error-class"},fe={class:"error-meta"},$e={class:"timestamp"},we={class:"header-actions"},xe={class:"error-content"},Ce={class:"error-main"},Ee={class:"tabs"},Ne=["onClick"],Te={class:"tab-content"},Se={key:0,class:"tab-panel"},Ae={class:"summary-section"},Oe={class:"status-section"},Ve={class:"message-section"},Be={class:"message-block"},Fe={key:0,class:"backtrace-section"},De={class:"location-section"},Le={key:0},Re={class:"tags-section"},Ie={class:"tags-list"},Je={key:1,class:"tab-panel"},Me={class:"comments-section"},Pe={class:"comment-form"},Ue={class:"comments-list"},je={class:"comment-header"},ze={class:"comment-author"},He={class:"comment-time"},We={class:"comment-body"},qe={key:2,class:"tab-panel"},Ge={key:3,class:"tab-panel"},Ke={class:"context-viewer"},Qe={key:0},Xe={key:1},Ye={key:4,class:"tab-panel"},Ze={key:5,class:"tab-panel"},et={class:"environment-viewer"},tt={key:0},st={key:1},at={key:6,class:"tab-panel"},ot={class:"history-list"},nt={class:"history-action"},lt={key:0,class:"history-user"},rt={class:"history-time"},ct={class:"error-sidebar"},it={class:"sidebar-widget"},dt={class:"stat-value"},ut={class:"sidebar-widget"},vt={class:"stat-value"},mt={class:"sidebar-widget"},_t={class:"stat-value"},bt={key:1,class:"loading"},ht={__name:"ErrorDetail",setup(v){const p=q(),_=G(),l=m(null),r=m(null),g=m([]),S=m([]),f=m(null),d=m("summary"),y=m(""),D=m(!1),L=[{key:"summary",label:"Summary"},{key:"comments",label:"Comments"},{key:"backtrace",label:"Backtrace"},{key:"context",label:"Context"},{key:"breadcrumbs",label:"Breadcrumbs"},{key:"environment",label:"Environment"},{key:"history",label:"History"}],$=async()=>{try{const c=p.params.id;l.value=await u(`/api/v1/faults/${c}`);const t=await u(`/api/v1/faults/${c}/notices?limit=1`);t.notices&&t.notices.length>0&&(r.value=t.notices[0]),f.value=await u(`/api/v1/faults/${c}/stats`);const x=await u(`/api/v1/faults/${c}/comments`);g.value=x.comments||[];const C=await u(`/api/v1/faults/${c}/history`);S.value=C.history||[]}catch(c){console.error("Error loading fault:",c)}},R=async c=>{try{const t=c?"resolve":"unresolve";await u(`/api/v1/faults/${l.value.id}/${t}`,{method:"POST"}),await $()}catch(t){console.error("Error updating resolved status:",t)}},I=async()=>{if(y.value.trim())try{await u(`/api/v1/faults/${l.value.id}/comments`,{method:"POST",body:JSON.stringify({comment:y.value,user_id:1})}),y.value="",await $()}catch(c){console.error("Error adding comment:",c)}},J=async()=>{console.log("Assign fault")},M=async()=>{try{await u(`/api/v1/faults/${l.value.id}/ignore`,{method:"POST"}),await $()}catch(c){console.error("Error ignoring fault:",c)}},P=()=>{console.log("Export fault")},U=async()=>{if(confirm("Are you sure you want to delete this error?"))try{await u(`/api/v1/faults/${l.value.id}`,{method:"DELETE"}),_.push("/errors")}catch(c){console.error("Error deleting fault:",c)}},w=c=>{console.log("Navigate",c)},k=c=>c?new Date(c).toLocaleString():"";return z(()=>{$()}),(c,t)=>{var x,C,A,O,V;return l.value?(a(),s("div",ye,[e("div",ke,[e("div",pe,[e("h1",ge,n(l.value.error_class),1),e("div",fe,[e("span",$e,n(k(l.value.last_seen_at)),1)])]),e("div",we,[e("button",{class:"nav-btn",onClick:t[0]||(t[0]=o=>w("first"))},"First"),e("button",{class:"nav-btn",onClick:t[1]||(t[1]=o=>w("prev"))},"Previous"),e("button",{class:"nav-btn",onClick:t[2]||(t[2]=o=>w("next"))},"Next"),e("button",{class:"nav-btn",onClick:t[3]||(t[3]=o=>w("last"))},"Last")])]),e("div",xe,[e("div",Ce,[e("div",Ee,[(a(),s(b,null,h(L,o=>e("button",{key:o.key,class:B(["tab-btn",{active:d.value===o.key}]),onClick:N=>d.value=o.key},n(o.label),11,Ne)),64))]),e("div",Te,[d.value==="summary"?(a(),s("div",Se,[e("div",Ae,[e("div",Oe,[E(K,{modelValue:l.value.resolved,"onUpdate:modelValue":[t[4]||(t[4]=o=>l.value.resolved=o),R]},null,8,["modelValue"])]),e("div",Ve,[t[7]||(t[7]=e("h3",null,"Message",-1)),e("pre",Be,n(l.value.message),1)]),r.value&&r.value.backtrace?(a(),s("div",Fe,[t[8]||(t[8]=e("h3",null,"Backtrace",-1)),E(F,{backtrace:r.value.backtrace},null,8,["backtrace"])])):i("",!0),e("div",De,[t[9]||(t[9]=e("h3",null,"Location",-1)),e("p",null,[e("span",{class:B(["env-badge",`env-${l.value.environment}`])},n(l.value.environment),3),r.value&&r.value.hostname?(a(),s("span",Le," on "+n(r.value.hostname),1)):i("",!0)])]),e("div",Re,[t[10]||(t[10]=e("h3",null,"Tags",-1)),e("div",Ie,[(a(!0),s(b,null,h(l.value.tags,o=>(a(),s("span",{key:o,class:"tag"},n(o),1))),128)),e("button",{class:"add-tag-btn",onClick:t[5]||(t[5]=o=>D.value=!0)},"+ Add Tag")])])])])):i("",!0),d.value==="comments"?(a(),s("div",Je,[e("div",Me,[e("div",Pe,[H(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=o=>y.value=o),placeholder:"Add a comment...",class:"comment-input"},null,512),[[W,y.value]]),e("button",{onClick:I,class:"btn btn-primary"},"Add Comment")]),e("div",Ue,[(a(!0),s(b,null,h(g.value,o=>{var N;return a(),s("div",{key:o.id,class:"comment-item"},[e("div",je,[e("span",ze,n(((N=o.user)==null?void 0:N.name)||"Unknown"),1),e("span",He,n(k(o.created_at)),1)]),e("div",We,n(o.comment),1)])}),128))])])])):i("",!0),d.value==="backtrace"?(a(),s("div",qe,[E(F,{backtrace:((x=r.value)==null?void 0:x.backtrace)||[]},null,8,["backtrace"])])):i("",!0),d.value==="context"?(a(),s("div",Ge,[e("div",Ke,[t[11]||(t[11]=e("h3",null,"Custom Context",-1)),r.value&&r.value.context?(a(),s("pre",Qe,"                "+n(JSON.stringify(r.value.context,null,2))+`
              `,1)):(a(),s("p",Xe,"No context data available"))])])):i("",!0),d.value==="breadcrumbs"?(a(),s("div",Ye,[E(he,{breadcrumbs:((C=r.value)==null?void 0:C.breadcrumbs)||[]},null,8,["breadcrumbs"])])):i("",!0),d.value==="environment"?(a(),s("div",Ze,[e("div",et,[t[12]||(t[12]=e("h3",null,"Application Environment",-1)),r.value&&r.value.environment?(a(),s("pre",tt,"                "+n(JSON.stringify(r.value.environment,null,2))+`
              `,1)):(a(),s("p",st,"No environment data available"))])])):i("",!0),d.value==="history"?(a(),s("div",at,[e("div",ot,[(a(!0),s(b,null,h(S.value,o=>(a(),s("div",{key:o.id,class:"history-item"},[e("div",nt,n(o.action),1),o.user?(a(),s("div",lt,n(o.user.name||o.user.email),1)):i("",!0),e("div",rt,n(k(o.created_at)),1)]))),128))])])):i("",!0)])]),e("div",ct,[e("div",it,[t[13]||(t[13]=e("h3",null,"Total Occurrences",-1)),e("div",dt,n(((A=f.value)==null?void 0:A.total_occurrences)||0),1)]),e("div",ut,[t[14]||(t[14]=e("h3",null,"Most Recently Occurred",-1)),e("div",vt,n(k((O=f.value)==null?void 0:O.last_occurred)),1)]),e("div",mt,[t[15]||(t[15]=e("h3",null,"First Occurred",-1)),e("div",_t,n(k((V=f.value)==null?void 0:V.first_occurred)),1)]),e("div",{class:"action-bar"},[t[16]||(t[16]=e("h3",null,"Actions",-1)),e("button",{class:"action-btn",onClick:J},"Assign"),e("button",{class:"action-btn",onClick:M},"Ignore"),e("button",{class:"action-btn",onClick:P},"Export"),e("button",{class:"action-btn",onClick:U},"Delete")])])])])):(a(),s("div",bt,"Loading..."))}}},pt=T(ht,[["__scopeId","data-v-bd487f7c"]]);export{pt as default};
